//Enabling conda by default when running locally
conda.enabled = true

//Pointing to data locally (default)
params {
    reads         = "data_/fastq_files/*_{1,2}.fastq"
    reference     = "data_/references/hg38.fa"
    bwa_index     = "data_/references/hg38.fa.{,amb,ann,bwt,pac,sa,fai}"
    dict          = "data_/references/hg38.dict"
    outdir        = "results"
}

process {
    stageInMode  = 'copy'
    stageOutMode = 'copy'
}


profiles {
  test {
    process.executor = 'local'
    conda.enabled = true
    docker.enabled = false
    //Pointing to test data locally (overrides default params)
    params {
        reads         = "data/fastq_files/*_{1,2}.fastq"                        //Artificially created using art_illumina 
        reference     = "data/references/mtDNA.fa"                              //Human mitochondrial DNA reference (NC_012920.1)
        bwa_index     = "data/references/mtDNA.fa.{,amb,ann,bwt,pac,sa,fai}"
        dict          = "data/references/mtDNA.dict"
        outdir        = "results"
          }
  }

  //AWS Batch profile
  aws_batch {
    process.memory = 7.GB
    process.cpus = 2
    process.executor = 'awsbatch'
    process.queue = 'nextflow-queue'
    aws.region = 'sa-east-1'

    workDir = 's3://pypeline-nextflow-bucket/work'
    
    conda.enabled = false //Disabling conda when running in AWS Batch
    docker.enabled = true
    //process.container = "roxicaro/pypeline-nextflow:latest"
    
    //Pointing to data in the S3 bucket (overrides default params)
    params {
        reads      = "s3://pypeline-nextflow-bucket/data/fastq_files/*_{1,2}.fastq"
        reference  = "s3://pypeline-nextflow-bucket/data/references/hg38.fa"
        bwa_index  = "s3://pypeline-nextflow-bucket/data/references/hg38.fa.{,amb,ann,bwt,pac,sa,fai}"
        dict       = "s3://pypeline-nextflow-bucket/data/references/hg38.dict"
        outdir     = "s3://pypeline-nextflow-bucket/results"
          }
  }

//Docker profile
docker {
    conda.enabled = false //Disabling conda when using docker
    docker.enabled = true
    docker.runOptions = "-u \$(id -u):\$(id -g)"
  }
}